
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A python library to work with molecules. Built on top of RDKit.">
      
      
      
      
      <link rel="icon" href="../images/logo.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.4">
    
    
      
        <title>datamol - datamol</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/css/custom.css">
    
      <link rel="stylesheet" href="../assets/css/custom-datamol.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#datamol" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="datamol" class="md-header__button md-logo" aria-label="datamol" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            datamol
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              datamol
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/datamol-org/datamol/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    datamol-org/datamol
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="datamol" class="md-nav__button md-logo" aria-label="datamol" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    datamol
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/datamol-org/datamol/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    datamol-org/datamol
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usage.html" class="md-nav__link">
        Usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/The_Basics.html" class="md-nav__link">
        The Basics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Preprocessing_Molecules.html" class="md-nav__link">
        Preprocessing Molecules
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Cluster_Molecules.html" class="md-nav__link">
        Cluster Molecules
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Fragment_and_Scaffold.html" class="md-nav__link">
        Fragment and Scaffold
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          datamol
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="datamol.html" class="md-nav__link md-nav__link--active">
        datamol
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datamol_viz" class="md-nav__link">
    datamol._viz
  </a>
  
    <nav class="md-nav" aria-label="datamol._viz">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.viz._viz.to_image" class="md-nav__link">
    to_image()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolcluster" class="md-nav__link">
    datamol.cluster
  </a>
  
    <nav class="md-nav" aria-label="datamol.cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.assign_to_centroids" class="md-nav__link">
    assign_to_centroids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.cluster_mols" class="md-nav__link">
    cluster_mols()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.pick_centroids" class="md-nav__link">
    pick_centroids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.pick_diverse" class="md-nav__link">
    pick_diverse()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolconvert" class="md-nav__link">
    datamol.convert
  </a>
  
    <nav class="md-nav" aria-label="datamol.convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_df" class="md-nav__link">
    from_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_inchi" class="md-nav__link">
    from_inchi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_selfies" class="md-nav__link">
    from_selfies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_df" class="md-nav__link">
    to_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchi" class="md-nav__link">
    to_inchi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchikey" class="md-nav__link">
    to_inchikey()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_selfies" class="md-nav__link">
    to_selfies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_smarts" class="md-nav__link">
    to_smarts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_smiles" class="md-nav__link">
    to_smiles()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamoldata" class="md-nav__link">
    datamol.data
  </a>
  
    <nav class="md-nav" aria-label="datamol.data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.data.freesolv" class="md-nav__link">
    freesolv()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolfp" class="md-nav__link">
    datamol.fp
  </a>
  
    <nav class="md-nav" aria-label="datamol.fp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.fp.fp_to_array" class="md-nav__link">
    fp_to_array()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.fp.to_fp" class="md-nav__link">
    to_fp()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolgraph" class="md-nav__link">
    datamol.graph
  </a>
  
    <nav class="md-nav" aria-label="datamol.graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.graph.get_all_path_between" class="md-nav__link">
    get_all_path_between()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.graph.to_graph" class="md-nav__link">
    to_graph()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolio" class="md-nav__link">
    datamol.io
  </a>
  
    <nav class="md-nav" aria-label="datamol.io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_csv" class="md-nav__link">
    read_csv()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_excel" class="md-nav__link">
    read_excel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_sdf" class="md-nav__link">
    read_sdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_smi" class="md-nav__link">
    read_smi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_sdf" class="md-nav__link">
    to_sdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_smi" class="md-nav__link">
    to_smi()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamoljobs" class="md-nav__link">
    datamol.jobs
  </a>
  
    <nav class="md-nav" aria-label="datamol.jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner" class="md-nav__link">
    JobRunner
  </a>
  
    <nav class="md-nav" aria-label="JobRunner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.is_sequential" class="md-nav__link">
    is_sequential
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.get_iterator_length" class="md-nav__link">
    get_iterator_length()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.parallel" class="md-nav__link">
    parallel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.sequential" class="md-nav__link">
    sequential()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.wrap_fn" class="md-nav__link">
    wrap_fn()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.parallelized" class="md-nav__link">
    parallelized()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamollog" class="md-nav__link">
    datamol.log
  </a>
  
    <nav class="md-nav" aria-label="datamol.log">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.log.disable_rdkit_log" class="md-nav__link">
    disable_rdkit_log()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.log.enable_rdkit_log" class="md-nav__link">
    enable_rdkit_log()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.log.without_rdkit_log" class="md-nav__link">
    without_rdkit_log
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolmol" class="md-nav__link">
    datamol.mol
  </a>
  
    <nav class="md-nav" aria-label="datamol.mol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.mol.adjust_singleton" class="md-nav__link">
    adjust_singleton()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.atom_indices_to_mol" class="md-nav__link">
    atom_indices_to_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol" class="md-nav__link">
    copy_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol_props" class="md-nav__link">
    copy_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.decrease_bond" class="md-nav__link">
    decrease_bond()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.enumerate_stereoisomers" class="md-nav__link">
    enumerate_stereoisomers()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.enumerate_tautomers" class="md-nav__link">
    enumerate_tautomers()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_mol" class="md-nav__link">
    fix_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence" class="md-nav__link">
    fix_valence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence_charge" class="md-nav__link">
    fix_valence_charge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.incorrect_valence" class="md-nav__link">
    incorrect_valence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.is_transition_metal" class="md-nav__link">
    is_transition_metal()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.keep_largest_fragment" class="md-nav__link">
    keep_largest_fragment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.randomize_atoms" class="md-nav__link">
    randomize_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.remove_dummies" class="md-nav__link">
    remove_dummies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.reorder_atoms" class="md-nav__link">
    reorder_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.replace_dummies_atoms" class="md-nav__link">
    replace_dummies_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_first" class="md-nav__link">
    sanitize_first()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_mol" class="md-nav__link">
    sanitize_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_smiles" class="md-nav__link">
    sanitize_smiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.set_dative_bonds" class="md-nav__link">
    set_dative_bonds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.set_mol_props" class="md-nav__link">
    set_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.standardize_mol" class="md-nav__link">
    standardize_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.standardize_smiles" class="md-nav__link">
    standardize_smiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_mol" class="md-nav__link">
    to_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_neutral" class="md-nav__link">
    to_neutral()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolsimilarity" class="md-nav__link">
    datamol.similarity
  </a>
  
    <nav class="md-nav" aria-label="datamol.similarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.similarity.cdist" class="md-nav__link">
    cdist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.similarity.pdist" class="md-nav__link">
    pdist()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="datamol.actions.html" class="md-nav__link">
        datamol.actions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="datamol.conformers.html" class="md-nav__link">
        datamol.conformers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="datamol.fragment.html" class="md-nav__link">
        datamol.fragment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="datamol.reactions.html" class="md-nav__link">
        datamol.reactions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="datamol.scaffold.html" class="md-nav__link">
        datamol.scaffold
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="datamol.utils.html" class="md-nav__link">
        datamol.utils
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="datamol.viz.html" class="md-nav__link">
        datamol.viz
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute.html" class="md-nav__link">
        Contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license.html" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datamol_viz" class="md-nav__link">
    datamol._viz
  </a>
  
    <nav class="md-nav" aria-label="datamol._viz">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.viz._viz.to_image" class="md-nav__link">
    to_image()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolcluster" class="md-nav__link">
    datamol.cluster
  </a>
  
    <nav class="md-nav" aria-label="datamol.cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.assign_to_centroids" class="md-nav__link">
    assign_to_centroids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.cluster_mols" class="md-nav__link">
    cluster_mols()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.pick_centroids" class="md-nav__link">
    pick_centroids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.pick_diverse" class="md-nav__link">
    pick_diverse()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolconvert" class="md-nav__link">
    datamol.convert
  </a>
  
    <nav class="md-nav" aria-label="datamol.convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_df" class="md-nav__link">
    from_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_inchi" class="md-nav__link">
    from_inchi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_selfies" class="md-nav__link">
    from_selfies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_df" class="md-nav__link">
    to_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchi" class="md-nav__link">
    to_inchi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchikey" class="md-nav__link">
    to_inchikey()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_selfies" class="md-nav__link">
    to_selfies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_smarts" class="md-nav__link">
    to_smarts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_smiles" class="md-nav__link">
    to_smiles()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamoldata" class="md-nav__link">
    datamol.data
  </a>
  
    <nav class="md-nav" aria-label="datamol.data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.data.freesolv" class="md-nav__link">
    freesolv()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolfp" class="md-nav__link">
    datamol.fp
  </a>
  
    <nav class="md-nav" aria-label="datamol.fp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.fp.fp_to_array" class="md-nav__link">
    fp_to_array()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.fp.to_fp" class="md-nav__link">
    to_fp()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolgraph" class="md-nav__link">
    datamol.graph
  </a>
  
    <nav class="md-nav" aria-label="datamol.graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.graph.get_all_path_between" class="md-nav__link">
    get_all_path_between()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.graph.to_graph" class="md-nav__link">
    to_graph()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolio" class="md-nav__link">
    datamol.io
  </a>
  
    <nav class="md-nav" aria-label="datamol.io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_csv" class="md-nav__link">
    read_csv()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_excel" class="md-nav__link">
    read_excel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_sdf" class="md-nav__link">
    read_sdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_smi" class="md-nav__link">
    read_smi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_sdf" class="md-nav__link">
    to_sdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_smi" class="md-nav__link">
    to_smi()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamoljobs" class="md-nav__link">
    datamol.jobs
  </a>
  
    <nav class="md-nav" aria-label="datamol.jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner" class="md-nav__link">
    JobRunner
  </a>
  
    <nav class="md-nav" aria-label="JobRunner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.is_sequential" class="md-nav__link">
    is_sequential
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.get_iterator_length" class="md-nav__link">
    get_iterator_length()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.parallel" class="md-nav__link">
    parallel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.sequential" class="md-nav__link">
    sequential()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.JobRunner.wrap_fn" class="md-nav__link">
    wrap_fn()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.utils.jobs.parallelized" class="md-nav__link">
    parallelized()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamollog" class="md-nav__link">
    datamol.log
  </a>
  
    <nav class="md-nav" aria-label="datamol.log">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.log.disable_rdkit_log" class="md-nav__link">
    disable_rdkit_log()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.log.enable_rdkit_log" class="md-nav__link">
    enable_rdkit_log()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.log.without_rdkit_log" class="md-nav__link">
    without_rdkit_log
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolmol" class="md-nav__link">
    datamol.mol
  </a>
  
    <nav class="md-nav" aria-label="datamol.mol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.mol.adjust_singleton" class="md-nav__link">
    adjust_singleton()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.atom_indices_to_mol" class="md-nav__link">
    atom_indices_to_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol" class="md-nav__link">
    copy_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol_props" class="md-nav__link">
    copy_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.decrease_bond" class="md-nav__link">
    decrease_bond()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.enumerate_stereoisomers" class="md-nav__link">
    enumerate_stereoisomers()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.enumerate_tautomers" class="md-nav__link">
    enumerate_tautomers()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_mol" class="md-nav__link">
    fix_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence" class="md-nav__link">
    fix_valence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence_charge" class="md-nav__link">
    fix_valence_charge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.incorrect_valence" class="md-nav__link">
    incorrect_valence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.is_transition_metal" class="md-nav__link">
    is_transition_metal()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.keep_largest_fragment" class="md-nav__link">
    keep_largest_fragment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.randomize_atoms" class="md-nav__link">
    randomize_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.remove_dummies" class="md-nav__link">
    remove_dummies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.reorder_atoms" class="md-nav__link">
    reorder_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.replace_dummies_atoms" class="md-nav__link">
    replace_dummies_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_first" class="md-nav__link">
    sanitize_first()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_mol" class="md-nav__link">
    sanitize_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_smiles" class="md-nav__link">
    sanitize_smiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.set_dative_bonds" class="md-nav__link">
    set_dative_bonds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.set_mol_props" class="md-nav__link">
    set_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.standardize_mol" class="md-nav__link">
    standardize_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.standardize_smiles" class="md-nav__link">
    standardize_smiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_mol" class="md-nav__link">
    to_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_neutral" class="md-nav__link">
    to_neutral()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamolsimilarity" class="md-nav__link">
    datamol.similarity
  </a>
  
    <nav class="md-nav" aria-label="datamol.similarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.similarity.cdist" class="md-nav__link">
    cdist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.similarity.pdist" class="md-nav__link">
    pdist()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/datamol-org/datamol/edit/master/docs/api/datamol.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="datamol"><code>datamol</code><a class="headerlink" href="#datamol" title="Permanent link">&para;</a></h1>
<p>All the below functions are accessible under <code>datamol.FUNCTION_NAME</code>.</p>
<h2 id="datamol_viz"><code>datamol._viz</code><a class="headerlink" href="#datamol_viz" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.viz._viz.to_image" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">_viz</span><span class="o">.</span><span class="n">to_image</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">use_svg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mol_size</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">highlight_atom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">highlight_bond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_mols</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.viz._viz.to_image" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Generate an image out of a molecule or a list of molecule.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>Union[List[rdkit.Chem.rdchem.Mol], rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>one or a list of molecules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>legends</code></td>
        <td><code>Union[List[Optional[str]], str]</code></td>
        <td><p>a string or a list of string as legend for every molecules.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_cols</code></td>
        <td><code>int</code></td>
        <td><p>number of molecules per column.</p></td>
        <td><code>4</code></td>
      </tr>
      <tr>
        <td><code>use_svg</code></td>
        <td><code>bool</code></td>
        <td><p>whether to ouput an SVG (or a PNG).</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>mol_size</code></td>
        <td><code>Union[Tuple[int, int], int]</code></td>
        <td><p>a int or a tuple of int defining the size per molecule.</p></td>
        <td><code>(200, 200)</code></td>
      </tr>
      <tr>
        <td><code>highlight_atom</code></td>
        <td><code>List[List[int]]</code></td>
        <td><p>atom to highlight.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>highlight_bond</code></td>
        <td><code>List[List[int]]</code></td>
        <td><p>bonds to highlight.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>outfile</code></td>
        <td><code>str</code></td>
        <td><p>path where to save the image (local or remote path).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_mols</code></td>
        <td><code>int</code></td>
        <td><p>the maximum number of molecules to display.</p></td>
        <td><code>32</code></td>
      </tr>
      <tr>
        <td><code>copy</code></td>
        <td><code>bool</code></td>
        <td><p>whether to copy the molecules or not.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>indices</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to draw the atom indices.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/viz/_viz.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_image</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">legends</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_cols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">use_svg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">mol_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
    <span class="n">highlight_atom</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">highlight_bond</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">outfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_mols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate an image out of a molecule or a list of molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: one or a list of molecules.</span>
<span class="sd">        legends: a string or a list of string as legend for every molecules.</span>
<span class="sd">        n_cols: number of molecules per column.</span>
<span class="sd">        use_svg: whether to ouput an SVG (or a PNG).</span>
<span class="sd">        mol_size: a int or a tuple of int defining the size per molecule.</span>
<span class="sd">        highlight_atom: atom to highlight.</span>
<span class="sd">        highlight_bond: bonds to highlight.</span>
<span class="sd">        outfile: path where to save the image (local or remote path).</span>
<span class="sd">        max_mols: the maximum number of molecules to display.</span>
<span class="sd">        copy: whether to copy the molecules or not.</span>
<span class="sd">        indices: Whether to draw the atom indices.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">mol_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">mol_size</span><span class="p">,</span> <span class="n">mol_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mols</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legends</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="n">legends</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">max_mols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[:</span><span class="n">max_mols</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">legends</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">legends</span> <span class="o">=</span> <span class="n">legends</span><span class="p">[:</span><span class="n">max_mols</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">atom_indices_to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">]</span>

    <span class="n">_highlight_atom</span> <span class="o">=</span> <span class="n">highlight_atom</span>
    <span class="k">if</span> <span class="n">highlight_atom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">highlight_atom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">_highlight_atom</span> <span class="o">=</span> <span class="p">[</span><span class="n">highlight_atom</span><span class="p">]</span>

    <span class="n">_highlight_bond</span> <span class="o">=</span> <span class="n">highlight_bond</span>
    <span class="k">if</span> <span class="n">highlight_bond</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">highlight_bond</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">_highlight_bond</span> <span class="o">=</span> <span class="p">[</span><span class="n">highlight_bond</span><span class="p">]</span>

    <span class="c1"># Don&#39;t make the image bigger than it</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_cols</span><span class="p">:</span>
        <span class="n">n_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>

    <span class="n">image</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span>
        <span class="n">mols</span><span class="p">,</span>
        <span class="n">legends</span><span class="o">=</span><span class="n">legends</span><span class="p">,</span>
        <span class="n">molsPerRow</span><span class="o">=</span><span class="n">n_cols</span><span class="p">,</span>
        <span class="n">useSVG</span><span class="o">=</span><span class="n">use_svg</span><span class="p">,</span>
        <span class="n">subImgSize</span><span class="o">=</span><span class="n">mol_size</span><span class="p">,</span>
        <span class="n">highlightAtomLists</span><span class="o">=</span><span class="n">_highlight_atom</span><span class="p">,</span>
        <span class="n">highlightBondLists</span><span class="o">=</span><span class="n">_highlight_bond</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">use_svg</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="c1"># in a terminal process</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># in a jupyter kernel process</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">PIL</span><span class="o">.</span><span class="n">PngImagePlugin</span><span class="o">.</span><span class="n">PngImageFile</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
                    <span class="c1"># in a terminal process</span>
                    <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># in a jupyter kernel process</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">image</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamolcluster"><code>datamol.cluster</code><a class="headerlink" href="#datamolcluster" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.cluster.assign_to_centroids" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">assign_to_centroids</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">feature_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dist_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#datamol.cluster.assign_to_centroids" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Assign molecules to centroids. Each molecule will be assigned to the closest centroid.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a list of molecules to assign to centroids</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>centroids</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>list of molecules to use as centroid</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>feature_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>A feature function that takes a Chem.rdchem.Mol object
and return molecular features. By default, the <code>dm.to_fp()</code> is used.
Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dist_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>A function that takes two indexes (i,j) and return the
distance between them. You might use partial to set the fingerprints as input.
By default, the Tanimoto similarity will be used. Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>clusters_map</code></td>
      <td><p>dict of index mapping each centroid index to the molecule index in the cluster
clusters_list: list of all molecules in each cluster. The cluster index follows the index of the centroid.
    Note that the centroid molecule is not added to the cluster.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/cluster.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">assign_to_centroids</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">centroids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">feature_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dist_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Assign molecules to centroids. Each molecule will be assigned to the closest centroid.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules to assign to centroids</span>
<span class="sd">        centroids: list of molecules to use as centroid</span>
<span class="sd">        feature_fn: A feature function that takes a Chem.rdchem.Mol object</span>
<span class="sd">            and return molecular features. By default, the `dm.to_fp()` is used.</span>
<span class="sd">            Default to None.</span>
<span class="sd">        dist_fn: A function that takes two indexes (i,j) and return the</span>
<span class="sd">            distance between them. You might use partial to set the fingerprints as input.</span>
<span class="sd">            By default, the Tanimoto similarity will be used. Default to None.</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>

<span class="sd">    Returns:</span>
<span class="sd">        clusters_map: dict of index mapping each centroid index to the molecule index in the cluster</span>
<span class="sd">        clusters_list: list of all molecules in each cluster. The cluster index follows the index of the centroid.</span>
<span class="sd">            Note that the centroid molecule is not added to the cluster.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">feature_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_fn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">all_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">centroids</span><span class="p">]</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">feature_fn</span><span class="p">,</span> <span class="n">all_mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">distij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">TanimotoSimilarity</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">features</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)])</span>

    <span class="k">if</span> <span class="n">dist_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dist_fn</span> <span class="o">=</span> <span class="n">distij</span>

    <span class="n">clusters_map</span> <span class="o">=</span> <span class="n">ddict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">clusters_list</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">centroids</span><span class="p">]</span>
    <span class="n">query_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">centroid_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centroids</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">query_inds</span><span class="p">,</span> <span class="n">centroid_inds</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">distij</span><span class="p">)</span>
    <span class="n">closest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">cluster_ind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">closest</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
        <span class="n">clusters_map</span><span class="p">[</span><span class="n">cluster_ind</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">clusters_list</span><span class="p">[</span><span class="n">cluster_ind</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">clusters_map</span><span class="p">,</span> <span class="n">clusters_list</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.cluster.cluster_mols" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">cluster_mols</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">feature_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#datamol.cluster.cluster_mols" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Cluster a set of molecules using the butina clustering algorithm and a given threshold.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a list of molecules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>cutoff</code></td>
        <td><code>float</code></td>
        <td><p>Cuttoff for the clustering. Default to 0.2.</p></td>
        <td><code>0.2</code></td>
      </tr>
      <tr>
        <td><code>feature_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>A feature function that takes a Chem.rdchem.Mol object
and return molecular features. By default, the <code>dm.to_fp()</code> is used.
Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/cluster.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cluster_mols</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">feature_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cluster a set of molecules using the butina clustering algorithm and a given threshold.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        cutoff: Cuttoff for the clustering. Default to 0.2.</span>
<span class="sd">        feature_fn: A feature function that takes a Chem.rdchem.Mol object</span>
<span class="sd">            and return molecular features. By default, the `dm.to_fp()` is used.</span>
<span class="sd">            Default to None.</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">feature_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_fn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">feature_fn</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)</span>

    <span class="n">dists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_mols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_mols</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">BulkTanimotoSimilarity</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">features</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">returnDistance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dists</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dist</span><span class="p">])</span>

    <span class="c1"># now cluster the data</span>
    <span class="n">cluster_indices</span> <span class="o">=</span> <span class="n">Butina</span><span class="o">.</span><span class="n">ClusterData</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">n_mols</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">isDistData</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cluster_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="o">*</span><span class="n">cluster</span><span class="p">)(</span><span class="n">mols</span><span class="p">)</span> <span class="k">for</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="n">cluster_indices</span><span class="p">]</span>

    <span class="c1"># Make single mol cluster a list</span>
    <span class="n">cluster_mols</span> <span class="o">=</span> <span class="p">[[</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_mols</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">cluster_indices</span><span class="p">,</span> <span class="n">cluster_mols</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.cluster.pick_centroids" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">pick_centroids</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">npick</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">initial_picks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">feature_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dist_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;sphere&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#datamol.cluster.pick_centroids" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Pick a set of <code>npick</code> centroids from a list of molecules.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a list of molecules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>npick</code></td>
        <td><code>int</code></td>
        <td><p>Number of element to pick from mols, including the preselection.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>threshold</code></td>
        <td><code>float</code></td>
        <td><p>Minimum distance between centroids for <code>maxmin</code> and sphere exclusion (<code>sphere</code>) methods.</p></td>
        <td><code>0.5</code></td>
      </tr>
      <tr>
        <td><code>initial_picks</code></td>
        <td><code>List[int]</code></td>
        <td><p>Starting list of index for molecules that should be in the
set of picked molecules. Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>feature_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>A feature function that takes a Chem.rdchem.Mol object
and return molecular features. By default, the <code>dm.to_fp()</code> is used.
Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dist_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>A function that takes two indexes (i,j) and return the
distance between them. You might use partial to set the fingerprints as input.
By default, the Tanimoto similarity will be used. Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>seed</code></td>
        <td><code>int</code></td>
        <td><p>seed for reproducibility</p></td>
        <td><code>42</code></td>
      </tr>
      <tr>
        <td><code>method</code></td>
        <td><code>str</code></td>
        <td><p>Picking method to use. One of  <code>sphere</code>, <code>maxmin</code> or any
supported rdkit hierarchical clustering method such as <code>centroid</code>, <code>clink</code>, <code>upgma</code></p></td>
        <td><code>&#39;sphere&#39;</code></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>picked_inds</code></td>
      <td><p>index of the molecule that have been selected as centroids
mols: molecules that have been picked</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/cluster.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pick_centroids</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">npick</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">initial_picks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">feature_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dist_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Pick a set of `npick` centroids from a list of molecules.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        npick: Number of element to pick from mols, including the preselection.</span>
<span class="sd">        threshold: Minimum distance between centroids for `maxmin` and sphere exclusion (`sphere`) methods.</span>
<span class="sd">        initial_picks: Starting list of index for molecules that should be in the</span>
<span class="sd">            set of picked molecules. Default to None.</span>
<span class="sd">        feature_fn (callable, optional): A feature function that takes a Chem.rdchem.Mol object</span>
<span class="sd">            and return molecular features. By default, the `dm.to_fp()` is used.</span>
<span class="sd">            Default to None.</span>
<span class="sd">        dist_fn: A function that takes two indexes (i,j) and return the</span>
<span class="sd">            distance between them. You might use partial to set the fingerprints as input.</span>
<span class="sd">            By default, the Tanimoto similarity will be used. Default to None.</span>
<span class="sd">        seed: seed for reproducibility</span>
<span class="sd">        method: Picking method to use. One of  `sphere`, `maxmin` or any</span>
<span class="sd">            supported rdkit hierarchical clustering method such as `centroid`, `clink`, `upgma`</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>

<span class="sd">    Returns:</span>
<span class="sd">        picked_inds: index of the molecule that have been selected as centroids</span>
<span class="sd">        mols: molecules that have been picked</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_mols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_fn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">feature_fn</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">distij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">TanimotoSimilarity</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">features</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">dist_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dist_fn</span> <span class="o">=</span> <span class="n">distij</span>

    <span class="n">initial_picks</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">initial_picks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">initial_picks</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;maxmin&quot;</span><span class="p">:</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">MaxMinPicker</span><span class="p">()</span>
        <span class="n">picked_inds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">LazyPickWithThreshold</span><span class="p">(</span>
            <span class="n">dist_fn</span><span class="p">,</span>
            <span class="n">n_mols</span><span class="p">,</span>
            <span class="n">pickSize</span><span class="o">=</span><span class="n">npick</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">firstPicks</span><span class="o">=</span><span class="n">initial_picks</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;sphere&quot;</span><span class="p">:</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">LeaderPicker</span><span class="p">()</span>
        <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">LazyPick</span><span class="p">(</span>
            <span class="n">dist_fn</span><span class="p">,</span> <span class="n">n_mols</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">pickSize</span><span class="o">=</span><span class="n">npick</span><span class="p">,</span> <span class="n">firstPicks</span><span class="o">=</span><span class="n">initial_picks</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">ClusterMethod</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">npick</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">initial_picks</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Initial picks is not supported by hierarchical clustering. You pick has been discarded.&quot;</span>
            <span class="p">)</span>

        <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span>
            <span class="n">distij</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">),</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">arg_type</span><span class="o">=</span><span class="s2">&quot;args&quot;</span>
        <span class="p">)</span>
        <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">)</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">HierarchicalClusterPicker</span><span class="p">(</span><span class="n">ClusterMethod</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
        <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">,</span> <span class="n">n_mols</span><span class="p">,</span> <span class="n">npick</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Picking method </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">npick</span><span class="si">}</span><span class="s2"> elements to pick is not supported.&quot;</span><span class="p">)</span>
    <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">picked_inds</span><span class="p">)</span>
    <span class="n">picked_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mols</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">picked_inds</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">picked_inds</span><span class="p">,</span> <span class="n">picked_mols</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.cluster.pick_diverse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">pick_diverse</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">npick</span><span class="p">,</span> <span class="n">initial_picks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feature_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dist_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


<a href="#datamol.cluster.pick_diverse" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Pick a set of diverse molecules based on they fingerprint.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a list of molecules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>npick</code></td>
        <td><code>int</code></td>
        <td><p>Number of element to pick from mols, including the preselection.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>initial_picks</code></td>
        <td><code>List[int]</code></td>
        <td><p>Starting list of index for molecules that should be in the
set of picked molecules. Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>feature_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>A feature function that takes a Chem.rdchem.Mol object
and return molecular features. By default, the <code>dm.to_fp()</code> is used.
Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dist_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>A function that takes two indexes (i,j) and return the
distance between them. You might use partial to set the fingerprints as input.
By default, the Tanimoto similarity will be used. Default to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>seed</code></td>
        <td><code>int</code></td>
        <td><p>seed for reproducibility</p></td>
        <td><code>42</code></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>picked_inds</code></td>
      <td><p>index of the molecule that have been picked
mols: molecules that have been picked</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/cluster.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pick_diverse</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">npick</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">initial_picks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">feature_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dist_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Pick a set of diverse molecules based on they fingerprint.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        npick: Number of element to pick from mols, including the preselection.</span>
<span class="sd">        initial_picks: Starting list of index for molecules that should be in the</span>
<span class="sd">            set of picked molecules. Default to None.</span>
<span class="sd">        feature_fn: A feature function that takes a Chem.rdchem.Mol object</span>
<span class="sd">            and return molecular features. By default, the `dm.to_fp()` is used.</span>
<span class="sd">            Default to None.</span>
<span class="sd">        dist_fn: A function that takes two indexes (i,j) and return the</span>
<span class="sd">            distance between them. You might use partial to set the fingerprints as input.</span>
<span class="sd">            By default, the Tanimoto similarity will be used. Default to None.</span>
<span class="sd">        seed: seed for reproducibility</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>

<span class="sd">    Returns:</span>
<span class="sd">        picked_inds: index of the molecule that have been picked</span>
<span class="sd">        mols: molecules that have been picked</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">feature_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_fn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">feature_fn</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">distij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">TanimotoSimilarity</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">features</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">dist_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dist_fn</span> <span class="o">=</span> <span class="n">distij</span>

    <span class="n">picker</span> <span class="o">=</span> <span class="n">MaxMinPicker</span><span class="p">()</span>
    <span class="n">initial_picks</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">initial_picks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">initial_picks</span>
    <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">LazyPick</span><span class="p">(</span><span class="n">dist_fn</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">),</span> <span class="n">npick</span><span class="p">,</span> <span class="n">firstPicks</span><span class="o">=</span><span class="n">initial_picks</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">picked_inds</span><span class="p">)</span>
    <span class="n">picked_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mols</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">picked_inds</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">picked_inds</span><span class="p">,</span> <span class="n">picked_mols</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamolconvert"><code>datamol.convert</code><a class="headerlink" href="#datamolconvert" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.from_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conserve_smiles</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.convert.from_df" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a dataframe to a list of mols.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code>smiles_column</code> is used to build the molecules, this property
is removed from the molecules' properties. You can decide to conserve
the SMILES column by setting <code>conserve_smiles</code> to True.</p>
</div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>DataFrame</code></td>
        <td><p>a dataframe.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>smiles_column</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Column name to extract the molecule.</p></td>
        <td><code>&#39;smiles&#39;</code></td>
      </tr>
      <tr>
        <td><code>mol_column</code></td>
        <td><code>str</code></td>
        <td><p>Column name to extract the molecule. It takes
precedence over <code>smiles_column</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>conserve_smiles</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to conserve the SMILES in the mols' props.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">from_df</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">conserve_smiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a dataframe to a list of mols.</span>

<span class="sd">    Note:</span>
<span class="sd">        If `smiles_column` is used to build the molecules, this property</span>
<span class="sd">        is removed from the molecules&#39; properties. You can decide to conserve</span>
<span class="sd">        the SMILES column by setting `conserve_smiles` to True.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: a dataframe.</span>
<span class="sd">        smiles_column: Column name to extract the molecule.</span>
<span class="sd">        mol_column: Column name to extract the molecule. It takes</span>
<span class="sd">            precedence over `smiles_column`.</span>
<span class="sd">        conserve_smiles: Whether to conserve the SMILES in the mols&#39; props.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either `smiles_column` or `mol_column` must be not None.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_row_to_mol</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="n">mol_column</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">conserve_smiles</span><span class="p">:</span>
                <span class="n">smiles</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If a SMILES column is used to create the molecule then it is removed from the</span>
                <span class="c1"># properties.</span>
                <span class="n">smiles</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">smiles_column</span><span class="p">)</span>

            <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">dm</span><span class="o">.</span><span class="n">set_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_row_to_mol</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.from_inchi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">from_inchi</span><span class="p">(</span><span class="n">inchi</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_hs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.convert.from_inchi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert an InChi to a mol.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>inchi</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>an inchi string.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sanitize</code></td>
        <td><code>bool</code></td>
        <td><p>do sanitize.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>remove_hs</code></td>
        <td><code>bool</code></td>
        <td><p>do remove hs.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>mol</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">from_inchi</span><span class="p">(</span>
    <span class="n">inchi</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert an InChi to a mol.</span>

<span class="sd">    Args:</span>
<span class="sd">        inchi: an inchi string.</span>
<span class="sd">        sanitize: do sanitize.</span>
<span class="sd">        remove_hs: do remove hs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">inchi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromInchi</span><span class="p">(</span><span class="n">inchi</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">,</span> <span class="n">removeHs</span><span class="o">=</span><span class="n">remove_hs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.from_selfies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">from_selfies</span><span class="p">(</span><span class="n">selfies</span><span class="p">,</span> <span class="n">as_mol</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.convert.from_selfies" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a SEFLIES to a smiles or a mol.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>selfies</code></td>
        <td><code>str</code></td>
        <td><p>a selfies.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>as_mol</code></td>
        <td><code>bool</code></td>
        <td><p>whether to return a mol or a smiles.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[str, rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>smiles or mol.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">from_selfies</span><span class="p">(</span><span class="n">selfies</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">as_mol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a SEFLIES to a smiles or a mol.</span>

<span class="sd">    Args:</span>
<span class="sd">        selfies: a selfies.</span>
<span class="sd">        as_mol (str, optional): whether to return a mol or a smiles.</span>

<span class="sd">    Returns:</span>
<span class="sd">        smiles or mol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">selfies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">selfies</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">as_mol</span> <span class="ow">and</span> <span class="n">smiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.to_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">render_df_mol</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">render_all_df_mol</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.convert.to_df" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a list of mols to a dataframe using each mol properties
as a column.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>smiles_column</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>name of the SMILES column.</p></td>
        <td><code>&#39;smiles&#39;</code></td>
      </tr>
      <tr>
        <td><code>mol_column</code></td>
        <td><code>str</code></td>
        <td><p>Name of the column. If not None, rdkit.Chem.PandaTools
is used to add a molecule column.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>include_private</code></td>
        <td><code>bool</code></td>
        <td><p>Include private properties in the columns.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>include_computed</code></td>
        <td><code>bool</code></td>
        <td><p>Include computed properties in the columns.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>render_df_mol</code></td>
        <td><code>bool</code></td>
        <td><p>whether to render the molecule in the dataframe to images.
If called once, it will be applied for the newly created dataframe with
mol in it.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>render_all_df_mol</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to render all pandas dataframe mol column as images.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_df</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">render_df_mol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">render_all_df_mol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a list of mols to a dataframe using each mol properties</span>
<span class="sd">    as a column.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a molecule.</span>
<span class="sd">        smiles_column: name of the SMILES column.</span>
<span class="sd">        mol_column: Name of the column. If not None, rdkit.Chem.PandaTools</span>
<span class="sd">            is used to add a molecule column.</span>
<span class="sd">        include_private: Include private properties in the columns.</span>
<span class="sd">        include_computed: Include computed properties in the columns.</span>
<span class="sd">        render_df_mol: whether to render the molecule in the dataframe to images.</span>
<span class="sd">            If called once, it will be applied for the newly created dataframe with</span>
<span class="sd">            mol in it.</span>
<span class="sd">        render_all_df_mol: Whether to render all pandas dataframe mol column as images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Init a dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># Feed it with smiles</span>
    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">smiles</span>

    <span class="c1"># Add a mol column</span>
    <span class="k">if</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">mol_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">mols</span>

    <span class="c1"># Add any other properties present in the molecule</span>
    <span class="n">props</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">mol</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">(</span>
            <span class="n">includePrivate</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span>
            <span class="n">includeComputed</span><span class="o">=</span><span class="n">include_computed</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span>
    <span class="p">]</span>
    <span class="n">props_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">smiles_column</span> <span class="ow">in</span> <span class="n">props_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The SMILES column name provided (&#39;</span><span class="si">{</span><span class="n">smiles_column</span><span class="si">}</span><span class="s2">&#39;) is already present in the properties&quot;</span>
            <span class="s2">&quot; of the molecules. THe returned dataframe will two columns with the same name.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Concat the df with the properties df</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">props_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Render mol column to images</span>
    <span class="k">if</span> <span class="n">render_df_mol</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># NOTE(hadim): replace by `PandaTools.ChangeMoleculeRendering` once</span>
        <span class="c1"># https://github.com/rdkit/rdkit/issues/3563 is fixed.</span>
        <span class="n">_ChangeMoleculeRendering</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">render_all_df_mol</span><span class="p">:</span>
            <span class="n">PandasTools</span><span class="o">.</span><span class="n">RenderImagesInAllDataFrames</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.to_inchi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_inchi</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.convert.to_inchi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a mol to Inchi.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Union[str, rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_inchi</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to Inchi.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToInchi</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.to_inchikey" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_inchikey</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.convert.to_inchikey" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a mol to Inchi key.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Union[str, rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a molecule</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_inchikey</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to Inchi key.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToInchiKey</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.to_selfies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_selfies</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.convert.to_selfies" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a mol to SELFIES.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Union[str, rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a molecule or a SMILES.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>selfies: SELFIES string.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_selfies</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to SELFIES.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule or a SMILES.</span>

<span class="sd">    Returns:</span>
<span class="sd">        selfies: SELFIES string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">selfies</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">selfies</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">selfies</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.to_smarts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_smarts</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">keep_hs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.convert.to_smarts" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a molecule to a smarts.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Union[str, rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>keep_hs</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to keep hydrogen. This will increase the count of H atoms
for atoms with attached hydrogens to create a valid smarts.
e.g. [H]-[CH2]-[<em>] -&gt; [H]-[CH3]-[</em>]</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>smarts of the molecule</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_smarts</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span> <span class="n">keep_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a molecule to a smarts.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        keep_hs: Whether to keep hydrogen. This will increase the count of H atoms</span>
<span class="sd">            for atoms with attached hydrogens to create a valid smarts.</span>
<span class="sd">            e.g. [H]-[CH2]-[*] -&gt; [H]-[CH3]-[*]</span>

<span class="sd">    Returns:</span>
<span class="sd">        smarts of the molecule</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="c1"># Change the isotope to 42</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">keep_hs</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">na</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetNeighbors</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">SetNumExplicitHs</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetIsotope</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

    <span class="c1"># Print out the smiles, all the atom attributes will be fully specified</span>
    <span class="n">smarts</span> <span class="o">=</span> <span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">explicit_bonds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">smarts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Remove the 42 isotope labels</span>
    <span class="n">smarts</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[42&quot;</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="n">smarts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">smarts</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.convert.to_smiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">canonical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explicit_bonds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explicit_hs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">randomize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cxsmiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_to_fail</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.convert.to_smiles" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a mol to a SMILES.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>canonical</code></td>
        <td><code>bool</code></td>
        <td><p>if false no attempt will be made to canonicalize the molecule.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>isomeric</code></td>
        <td><code>bool</code></td>
        <td><p>whether to include information about stereochemistry in the SMILES.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>ordered</code></td>
        <td><code>bool</code></td>
        <td><p>whether to force reordering of the atoms first.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>explicit_bonds</code></td>
        <td><code>bool</code></td>
        <td><p>if true, all bond orders will be explicitly indicated in the output SMILES.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>explicit_hs</code></td>
        <td><code>bool</code></td>
        <td><p>if true, all H counts will be explicitly indicated in the output SMILES.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>randomize</code></td>
        <td><code>bool</code></td>
        <td><p>whether to randomize the generated smiles. Override <code>canonical</code>.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>cxsmiles</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return a CXSMILES instead of a SMILES.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>allow_to_fail</code></td>
        <td><code>bool</code></td>
        <td><p>Raise an error if the conversion to SMILES fails. Return None otherwise.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_smiles</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">canonical</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">isomeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">explicit_bonds</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">explicit_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">randomize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">cxsmiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">allow_to_fail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to a SMILES.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        canonical: if false no attempt will be made to canonicalize the molecule.</span>
<span class="sd">        isomeric: whether to include information about stereochemistry in the SMILES.</span>
<span class="sd">        ordered: whether to force reordering of the atoms first.</span>
<span class="sd">        explicit_bonds: if true, all bond orders will be explicitly indicated in the output SMILES.</span>
<span class="sd">        explicit_hs: if true, all H counts will be explicitly indicated in the output SMILES.</span>
<span class="sd">        randomize: whether to randomize the generated smiles. Override `canonical`.</span>
<span class="sd">        cxsmiles: Whether to return a CXSMILES instead of a SMILES.</span>
<span class="sd">        allow_to_fail: Raise an error if the conversion to SMILES fails. Return None otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ordered</span> <span class="ow">and</span> <span class="n">canonical</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">reorder_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">randomize</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">randomize_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">canonical</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">cxsmiles</span><span class="p">:</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToCXSmiles</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
                <span class="n">mol</span><span class="p">,</span>
                <span class="n">isomericSmiles</span><span class="o">=</span><span class="n">isomeric</span><span class="p">,</span>
                <span class="n">canonical</span><span class="o">=</span><span class="n">canonical</span><span class="p">,</span>
                <span class="n">allBondsExplicit</span><span class="o">=</span><span class="n">explicit_bonds</span><span class="p">,</span>
                <span class="n">allHsExplicit</span><span class="o">=</span><span class="n">explicit_hs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
                <span class="n">mol</span><span class="p">,</span>
                <span class="n">isomericSmiles</span><span class="o">=</span><span class="n">isomeric</span><span class="p">,</span>
                <span class="n">canonical</span><span class="o">=</span><span class="n">canonical</span><span class="p">,</span>
                <span class="n">allBondsExplicit</span><span class="o">=</span><span class="n">explicit_bonds</span><span class="p">,</span>
                <span class="n">allHsExplicit</span><span class="o">=</span><span class="n">explicit_hs</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">allow_to_fail</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamoldata"><code>datamol.data</code><a class="headerlink" href="#datamoldata" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.data.freesolv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">freesolv</span><span class="p">()</span></code>


<a href="#datamol.data.freesolv" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">


        <details class="quote">
          <summary>Source code in <code>datamol/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">freesolv</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_stream</span><span class="p">(</span><span class="s2">&quot;datamol&quot;</span><span class="p">,</span> <span class="s2">&quot;data/freesolv.csv&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamolfp"><code>datamol.fp</code><a class="headerlink" href="#datamolfp" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.fp.fp_to_array" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">fp_to_array</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">int</span><span class="s1">&#39;&gt;)</span></code>


<a href="#datamol.fp.fp_to_array" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert rdkit fingerprint to numpy array.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This implementation has shown to be faster than using <code>DataStructs.ConvertToNumpyArray</code>
by a factor of ~4.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>datamol/fp.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fp_to_array</span><span class="p">(</span><span class="n">fp</span><span class="p">:</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">ExplicitBitVect</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert rdkit fingerprint to numpy array.</span>

<span class="sd">    Note:</span>
<span class="sd">        This implementation has shown to be faster than using `DataStructs.ConvertToNumpyArray`</span>
<span class="sd">        by a factor of ~4.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">fp</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">ToBitString</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="s2">&quot;u1&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.fp.to_fp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">to_fp</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">fp_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">use_features</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.fp.to_fp" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Transform a molecule from smiles to morgan fingerprint.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>That function should be expanded to compute more type of fingerprints.</p>
</div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Union[str, rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a molecule or a SMILES.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fp_size</code></td>
        <td><code>int</code></td>
        <td><p>Size of morgan fingerprint. Default to 2048.</p></td>
        <td><code>2048</code></td>
      </tr>
      <tr>
        <td><code>radius</code></td>
        <td><code>int</code></td>
        <td><p>Radius of the morgan fingerprints. Default to 3.</p></td>
        <td><code>3</code></td>
      </tr>
      <tr>
        <td><code>use_features</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use atom features. Default to True.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>as_array</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return a numpy array of an RDKit vec. Default to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[numpy.ndarray, rdkit.DataStructs.cDataStructs.ExplicitBitVect]</code></td>
      <td><p>A fingerprint vector or None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/fp.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_fp</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">fp_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">radius</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_features</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">as_array</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">ExplicitBitVect</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Transform a molecule from smiles to morgan fingerprint.</span>

<span class="sd">    Note:</span>
<span class="sd">        That function should be expanded to compute more type of fingerprints.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol (Chem.Mol or str): a molecule or a SMILES.</span>
<span class="sd">        fp_size (int, optional): Size of morgan fingerprint. Default to 2048.</span>
<span class="sd">        radius (int, optional): Radius of the morgan fingerprints. Default to 3.</span>
<span class="sd">        use_features: Whether to use atom features. Default to True.</span>
<span class="sd">        as_array: Whether to return a numpy array of an RDKit vec. Default to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A fingerprint vector or None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">fp</span> <span class="o">=</span> <span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">GetMorganFingerprintAsBitVect</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">radius</span><span class="p">,</span>
        <span class="n">nBits</span><span class="o">=</span><span class="n">fp_size</span><span class="p">,</span>
        <span class="n">useFeatures</span><span class="o">=</span><span class="n">use_features</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">as_array</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fp_to_array</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fp</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamolgraph"><code>datamol.graph</code><a class="headerlink" href="#datamolgraph" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.graph.get_all_path_between" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_all_path_between</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_idx_1</span><span class="p">,</span> <span class="n">atom_idx_2</span><span class="p">,</span> <span class="n">ignore_cycle_basis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.graph.get_all_path_between" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Get all simple path between two atoms of a molecule</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>atom_idx_1</code></td>
        <td><code>int</code></td>
        <td><p>Atom index 1.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>atom_idx_2</code></td>
        <td><code>int</code></td>
        <td><p>Atom index 2.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ignore_cycle_basis</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to ignore cycle basis.
Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>[type]</code></td>
      <td><p>[description]</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/graph.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_all_path_between</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">atom_idx_1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">atom_idx_2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_cycle_basis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get all simple path between two atoms of a molecule</span>

<span class="sd">    Args:</span>
<span class="sd">        mol (Chem.Mol): a molecule</span>
<span class="sd">        atom_idx_1 (int): Atom index 1.</span>
<span class="sd">        atom_idx_2 (int): Atom index 2.</span>
<span class="sd">        ignore_cycle_basis: Whether to ignore cycle basis.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [type]: [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="n">_get_networkx</span><span class="p">()</span>

    <span class="n">adj</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdmolops</span><span class="o">.</span><span class="n">GetAdjacencyMatrix</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">atom_idx_1</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">atom_idx_2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ignore_cycle_basis</span><span class="p">:</span>
        <span class="n">rings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetRingInfo</span><span class="p">()</span><span class="o">.</span><span class="n">AtomRings</span><span class="p">()]</span>
        <span class="n">final_path</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">reject_path</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rings</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
                    <span class="n">reject_path</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">reject_path</span><span class="p">:</span>
                <span class="n">final_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">final_path</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.graph.to_graph" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">to_graph</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.graph.to_graph" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert a molecule to a network x graph. A list of properties are added
to every nodes and edges.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>mol_graph (networkx.Graph)</code></td>
      <td><p>a graph representing the molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/graph.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_graph</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">Mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a molecule to a network x graph. A list of properties are added</span>
<span class="sd">    to every nodes and edges.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol (Chem.Mol): a molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol_graph (networkx.Graph): a graph representing the molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="n">_get_networkx</span><span class="p">()</span>

    <span class="n">mol_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="n">mol_graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span>
            <span class="n">atomic_num</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">(),</span>
            <span class="n">formal_charge</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">(),</span>
            <span class="n">chiral_tag</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetChiralTag</span><span class="p">(),</span>
            <span class="n">hybridization</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetHybridization</span><span class="p">(),</span>
            <span class="n">num_explicit_hs</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetNumExplicitHs</span><span class="p">(),</span>
            <span class="n">implicit_valence</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetImplicitValence</span><span class="p">(),</span>
            <span class="n">degree</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetDegree</span><span class="p">(),</span>
            <span class="n">symbol</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">(),</span>
            <span class="n">ring_atom</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">IsInRing</span><span class="p">(),</span>
            <span class="n">is_aromatic</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIsAromatic</span><span class="p">(),</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
        <span class="n">mol_graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span>
            <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span>
            <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">(),</span>
            <span class="n">bond_type</span><span class="o">=</span><span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">(),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">mol_graph</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamolio"><code>datamol.io</code><a class="headerlink" href="#datamolio" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.io.read_csv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#datamol.io.read_csv" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Read a CSV file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>urlpath</code></td>
        <td><code>Union[str, os.PathLike, TextIO]</code></td>
        <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>smiles_column</code></td>
        <td><code>str</code></td>
        <td><p>Use this column to build a mol column.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>mol_column</code></td>
        <td><code>str</code></td>
        <td><p>Name to give to the mol column. If not None a mol column will be build.
Avoid when loading a very large file.</p></td>
        <td><code>&#39;mol&#39;</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td><code></code></td>
        <td><p>Arguments to pass to <code>pd.read_csv()</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>df: a <code>pandas.DataFrame</code></p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_csv</span><span class="p">(</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mol&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Read a CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        smiles_column: Use this column to build a mol column.</span>
<span class="sd">        mol_column: Name to give to the mol column. If not None a mol column will be build.</span>
<span class="sd">            Avoid when loading a very large file.</span>
<span class="sd">        kwargs: Arguments to pass to `pd.read_csv()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        df: a `pandas.DataFrame`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">smiles_column</span><span class="p">,</span> <span class="n">mol_column</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.io.read_excel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#datamol.io.read_excel" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Read an excel file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>urlpath</code></td>
        <td><code>Union[str, os.PathLike, TextIO]</code></td>
        <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sheet_name</code></td>
        <td><code>Union[str, int, list]</code></td>
        <td><p>see <code>pandas.read_excel()</code> doc.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>mol_column</code></td>
        <td><code>str</code></td>
        <td><p>Name to give to the mol column. If not None a mol column will be build.
Avoid when loading a very large file.</p></td>
        <td><code>&#39;mol&#39;</code></td>
      </tr>
      <tr>
        <td><code>mol_column</code></td>
        <td><code>str</code></td>
        <td><p>name to give to the mol column.</p></td>
        <td><code>&#39;mol&#39;</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td><code></code></td>
        <td><p>Arguments to pass to <code>pd.read_excel()</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>DataFrame</code></td>
      <td><p>df: a <code>pandas.DataFrame</code></p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_excel</span><span class="p">(</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span>
    <span class="n">sheet_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mol&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Read an excel file.</span>

<span class="sd">    Args:</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        sheet_name: see `pandas.read_excel()` doc.</span>
<span class="sd">        mol_column: Name to give to the mol column. If not None a mol column will be build.</span>
<span class="sd">            Avoid when loading a very large file.</span>
<span class="sd">        mol_column: name to give to the mol column.</span>
<span class="sd">        kwargs: Arguments to pass to `pd.read_excel()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        df: a `pandas.DataFrame`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">smiles_column</span><span class="p">,</span> <span class="n">mol_column</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.io.read_sdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_sdf</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">as_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.io.read_sdf" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Read an SDF file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>urlpath</code></td>
        <td><code>Union[str, os.PathLike, TextIO]</code></td>
        <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>as_df</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return a list mol or a pandas DataFrame.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>smiles_column</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Name of the SMILES column. Only relevant if <code>as_df</code> is True.</p></td>
        <td><code>&#39;smiles&#39;</code></td>
      </tr>
      <tr>
        <td><code>mol_column</code></td>
        <td><code>str</code></td>
        <td><p>Name of the mol column. Only relevant if <code>as_df</code> is True.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>include_private</code></td>
        <td><code>bool</code></td>
        <td><p>Include private properties in the columns.  Only relevant if
<code>as_df</code> is True.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>include_computed</code></td>
        <td><code>bool</code></td>
        <td><p>Include computed properties in the columns.  Only relevant if
<code>as_df</code> is True.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_sdf</span><span class="p">(</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span>
    <span class="n">as_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Read an SDF file.</span>

<span class="sd">    Args:</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        as_df: Whether to return a list mol or a pandas DataFrame.</span>
<span class="sd">        smiles_column: Name of the SMILES column. Only relevant if `as_df` is True.</span>
<span class="sd">        mol_column: Name of the mol column. Only relevant if `as_df` is True.</span>
<span class="sd">        include_private: Include private properties in the columns.  Only relevant if</span>
<span class="sd">            `as_df` is True.</span>
<span class="sd">        include_computed: Include computed properties in the columns.  Only relevant if</span>
<span class="sd">            `as_df` is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># File-like object</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">):</span>
        <span class="n">supplier</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ForwardSDMolSupplier</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">supplier</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># Regular local or remote paths</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gz&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gzip&quot;</span><span class="p">):</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">supplier</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ForwardSDMolSupplier</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">supplier</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">as_df</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span>
            <span class="n">mols</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">mol_column</span><span class="o">=</span><span class="n">mol_column</span><span class="p">,</span>
            <span class="n">include_private</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span>
            <span class="n">include_computed</span><span class="o">=</span><span class="n">include_computed</span><span class="p">,</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">mols</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.io.read_smi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_smi</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span></code>


<a href="#datamol.io.read_smi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Read a list of smiles from am <code>.smi</code> file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>urlpath</code></td>
        <td><code>Union[str, os.PathLike]</code></td>
        <td><p>Path to a file or a file-like object. Path can be remote or local.
Note: file-like object are not supported yet.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_smi</span><span class="p">(</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Read a list of smiles from am `.smi` file.</span>

<span class="sd">    Args:</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">            Note: file-like object are not supported yet.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">active_path</span> <span class="o">=</span> <span class="n">urlpath</span>

    <span class="c1"># NOTE(hadim): the temporary local file copy</span>
    <span class="c1"># is because `SmilesMolSupplier` does not support</span>
    <span class="c1"># using file-like object, only path.</span>

    <span class="c1"># Copy to a local temporary path if the path is a remote one.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">can_be_local</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)):</span>
        <span class="n">active_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">dm</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">copy_file</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">active_path</span><span class="p">)</span>

    <span class="c1"># Read the molecules</span>
    <span class="n">supplier</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">SmilesMolSupplier</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">active_path</span><span class="p">),</span> <span class="n">titleLine</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">supplier</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># Delete the local temporary path</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">can_be_local</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)):</span>
        <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">active_path</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">mols</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.io.to_sdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">to_sdf</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">urlpath</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#datamol.io.to_sdf" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Write molecules to a file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>Union[Sequence[rdkit.Chem.rdchem.Mol], pandas.core.frame.DataFrame]</code></td>
        <td><p>a dataframe or a list of molecule.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>urlpath</code></td>
        <td><code>Union[str, os.PathLike, TextIO]</code></td>
        <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>smiles_column</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Column name to extract the molecule.</p></td>
        <td><code>&#39;smiles&#39;</code></td>
      </tr>
      <tr>
        <td><code>mol_column</code></td>
        <td><code>str</code></td>
        <td><p>Column name to extract the molecule. It takes
precedence over <code>smiles_column</code>.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_sdf</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write molecules to a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a dataframe or a list of molecule.</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        smiles_column: Column name to extract the molecule.</span>
<span class="sd">        mol_column: Column name to extract the molecule. It takes</span>
<span class="sd">            precedence over `smiles_column`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="n">mol_column</span><span class="p">)</span>

    <span class="c1"># Filter out None values</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># File-like object</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">):</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">SDWriter</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Regular local or remote paths</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">SDWriter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.io.to_smi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">to_smi</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">urlpath</span><span class="p">,</span> <span class="n">error_if_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.io.to_smi" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Save a list of molecules in an <code>.smi</code> file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>Sequence[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a list of molecules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>urlpath</code></td>
        <td><code>Union[str, os.PathLike, TextIO]</code></td>
        <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>error_if_empty</code></td>
        <td><code>bool</code></td>
        <td><p>whether to raise and error if the input list is empty.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_smi</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span>
    <span class="n">error_if_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save a list of molecules in an `.smi` file.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        error_if_empty: whether to raise and error if the input list is empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">error_if_empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The list of mols/smiles provided is empty.&quot;</span><span class="p">)</span>

    <span class="c1"># Filter out None values</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># File-like object</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">):</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">SmilesWriter</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">includeHeader</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nameHeader</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Regular local or remote paths</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">SmilesWriter</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">includeHeader</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nameHeader</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamoljobs"><code>datamol.jobs</code><a class="headerlink" href="#datamoljobs" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-class">



<h3 id="datamol.utils.jobs.JobRunner" class="doc doc-heading">
        <code>datamol.utils.jobs.JobRunner</code>



<a href="#datamol.utils.jobs.JobRunner" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">





  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 id="datamol.utils.jobs.JobRunner.is_sequential" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_sequential</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#datamol.utils.jobs.JobRunner.is_sequential" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Check whether the job is sequential or parallel</p>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h4 id="datamol.utils.jobs.JobRunner.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#datamol.utils.jobs.JobRunner.__call__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Run job using the n_jobs attribute to determine regime</p>

        <details class="quote">
          <summary>Source code in <code>datamol/utils/jobs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run job using the n_jobs attribute to determine regime</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_sequential</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequential</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="datamol.utils.jobs.JobRunner.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">job_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#datamol.utils.jobs.JobRunner.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>JobRunner with sequential/parallel regimes. The multiprocessing backend use joblib which
allows taking advantage of its features, while the progress bar use tqdm</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of process. Use 0 or None to force sequential.
Use -1 to use all the available processors. For details see
<a href="https://joblib.readthedocs.io/en/latest/parallel.html#parallel-reference-documentation">https://joblib.readthedocs.io/en/latest/parallel.html#parallel-reference-documentation</a></p></td>
        <td><code>-1</code></td>
      </tr>
      <tr>
        <td><code>prefer</code></td>
        <td><code>str</code></td>
        <td><p>Choose from ['processes', 'threads'] or None. Default to None.
Soft hint to choose the default backend if no specific backend
was selected with the parallel_backend context manager. The
default process-based backend is 'loky' and the default
thread-based backend is 'threading'. Ignored if the <code>backend</code>
parameter is specified.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>progress</code></td>
        <td><code>bool</code></td>
        <td><p>whether to display progress bar</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>job_kwargs</code></td>
        <td><code></code></td>
        <td><p>Any additional keyword argument supported by joblib.Parallel.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    
      <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datamol</span> <span class="k">as</span> <span class="nn">dm</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">JobRunner</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">runner</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>datamol/utils/jobs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">prefer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">job_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    JobRunner with sequential/parallel regimes. The multiprocessing backend use joblib which</span>
<span class="sd">    allows taking advantage of its features, while the progress bar use tqdm</span>

<span class="sd">    Args:</span>
<span class="sd">        n_jobs: Number of process. Use 0 or None to force sequential.</span>
<span class="sd">            Use -1 to use all the available processors. For details see</span>
<span class="sd">            https://joblib.readthedocs.io/en/latest/parallel.html#parallel-reference-documentation</span>
<span class="sd">        prefer: Choose from [&#39;processes&#39;, &#39;threads&#39;] or None. Default to None.</span>
<span class="sd">            Soft hint to choose the default backend if no specific backend</span>
<span class="sd">            was selected with the parallel_backend context manager. The</span>
<span class="sd">            default process-based backend is &#39;loky&#39; and the default</span>
<span class="sd">            thread-based backend is &#39;threading&#39;. Ignored if the ``backend``</span>
<span class="sd">            parameter is specified.</span>
<span class="sd">        progress: whether to display progress bar</span>
<span class="sd">        job_kwargs: Any additional keyword argument supported by joblib.Parallel.</span>

<span class="sd">    Example:</span>

<span class="sd">    ```python</span>
<span class="sd">    import datamol as dm</span>
<span class="sd">    runner = dm.JobRunner(n_jobs=4, progress=True, prefer=&quot;threads&quot;)</span>
<span class="sd">    results = runner(lambda x: x**2, [1, 2, 3, 4])</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prefer</span> <span class="o">=</span> <span class="n">prefer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">job_kwargs</span> <span class="o">=</span> <span class="n">job_kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">job_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">no_progress</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">progress</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="datamol.utils.jobs.JobRunner.get_iterator_length" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_iterator_length</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#datamol.utils.jobs.JobRunner.get_iterator_length" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Attempt to get the length of an iterator</p>

        <details class="quote">
          <summary>Source code in <code>datamol/utils/jobs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_iterator_length</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Attempt to get the length of an iterator&quot;&quot;&quot;</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">total_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c1"># most likely a generator, ignore</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">total_length</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="datamol.utils.jobs.JobRunner.parallel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parallel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callable_fn</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">arg_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">)</span></code>


<a href="#datamol.utils.jobs.JobRunner.parallel" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Run job in parallel</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>callable_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>function to call</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>Iterable[Any]</code></td>
        <td><p>input data</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>arg_type</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>function argument type ('arg'/None or 'args' or 'kwargs')</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fn_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>optional keyword argument to pass to the callable funciton</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/utils/jobs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parallel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">callable_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">arg_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run job in parallel</span>

<span class="sd">    Args:</span>
<span class="sd">        callable_fn (callable): function to call</span>
<span class="sd">        data (iterable): input data</span>
<span class="sd">        arg_type (str, optional): function argument type (&#39;arg&#39;/None or &#39;args&#39; or &#39;kwargs&#39;)</span>
<span class="sd">        fn_kwargs (dict, optional): optional keyword argument to pass to the callable funciton</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="n">JobRunner</span><span class="o">.</span><span class="n">_parallel_helper</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">job_kwargs</span><span class="p">)</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="n">JobRunner</span><span class="o">.</span><span class="n">get_iterator_length</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">runner</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total_length</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">no_progress</span><span class="p">)(</span>
        <span class="n">delayed</span><span class="p">(</span><span class="n">JobRunner</span><span class="o">.</span><span class="n">wrap_fn</span><span class="p">(</span><span class="n">callable_fn</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">))(</span><span class="n">dt</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">data</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="datamol.utils.jobs.JobRunner.sequential" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sequential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callable_fn</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">arg_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">)</span></code>


<a href="#datamol.utils.jobs.JobRunner.sequential" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Run job in sequential version</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>callable_fn</code></td>
        <td><code>Callable</code></td>
        <td><p>function to call</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>Iterable[Any]</code></td>
        <td><p>input data</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>arg_type</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>function argument type ('arg'/None or 'args' or 'kwargs')</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fn_kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>optional keyword argument to pass to the callable funciton</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/utils/jobs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sequential</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">callable_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">arg_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run job in sequential version</span>

<span class="sd">    Args:</span>
<span class="sd">        callable_fn (callable): function to call</span>
<span class="sd">        data (iterable): input data</span>
<span class="sd">        arg_type (str, optional): function argument type (&#39;arg&#39;/None or &#39;args&#39; or &#39;kwargs&#39;)</span>
<span class="sd">        fn_kwargs (dict, optional): optional keyword argument to pass to the callable funciton</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="n">JobRunner</span><span class="o">.</span><span class="n">get_iterator_length</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">JobRunner</span><span class="o">.</span><span class="n">wrap_fn</span><span class="p">(</span><span class="n">callable_fn</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">)(</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">total_length</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">no_progress</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="datamol.utils.jobs.JobRunner.wrap_fn" class="doc doc-heading">
<code class="highlight language-python"><span class="n">wrap_fn</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">arg_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#datamol.utils.jobs.JobRunner.wrap_fn" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Small wrapper around a callable to properly format it's argument</p>

        <details class="quote">
          <summary>Source code in <code>datamol/utils/jobs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">wrap_fn</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Small wrapper around a callable to properly format it&#39;s argument&quot;&quot;&quot;</span>
    <span class="c1"># EN probably use something like (moms.utils.commons.is_callable) ?</span>
    <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">arg_type</span> <span class="o">==</span> <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span>
            <span class="n">fn_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">**</span><span class="n">fn_kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">arg_type</span> <span class="o">==</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_run</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.utils.jobs.parallelized" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">inputs_list</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;processes&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">arg_type</span><span class="o">=</span><span class="s1">&#39;arg&#39;</span><span class="p">)</span></code>


<a href="#datamol.utils.jobs.parallelized" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Run a function in parallel.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>fn</code></td>
        <td><code>Callable</code></td>
        <td><p>The function to run in parallel.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inputs_list</code></td>
        <td><code>Iterable[Any]</code></td>
        <td><p>List of inputs to pass to <code>fn</code>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>scheduler</code></td>
        <td><code>str</code></td>
        <td><p>Choose between ["processes", "threads"]. Defaults
to None which uses the default joblib "loky" scheduler.</p></td>
        <td><code>&#39;processes&#39;</code></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of process. Use 0 or None to force sequential.
    Use -1 to use all the available processors. For details see
    <a href="https://joblib.readthedocs.io/en/latest/parallel.html#parallel-reference-documentation">https://joblib.readthedocs.io/en/latest/parallel.html#parallel-reference-documentation</a></p></td>
        <td><code>-1</code></td>
      </tr>
      <tr>
        <td><code>progress</code></td>
        <td><code>bool</code></td>
        <td><p>Display a progress bar. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>arg_type</code></td>
        <td><code>str</code></td>
        <td><p>One of ["arg", "args", "kwargs]:
- "arg": the input is passed as an argument: <code>fn(arg)</code> (default).
- "args": the input is passed as a list: <code>fn(*args)</code>.
- "kwargs": the input is passed as a map: <code>fn(**kwargs)</code>.</p></td>
        <td><code>&#39;arg&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[List[Any]]</code></td>
      <td><p>The results of the execution as a list.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/utils/jobs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parallelized</span><span class="p">(</span>
    <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">inputs_list</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">scheduler</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;processes&quot;</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">arg_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;arg&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Run a function in parallel.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn: The function to run in parallel.</span>
<span class="sd">        inputs_list: List of inputs to pass to `fn`.</span>
<span class="sd">        scheduler: Choose between [&quot;processes&quot;, &quot;threads&quot;]. Defaults</span>
<span class="sd">            to None which uses the default joblib &quot;loky&quot; scheduler.</span>
<span class="sd">        n_jobs: Number of process. Use 0 or None to force sequential.</span>
<span class="sd">                Use -1 to use all the available processors. For details see</span>
<span class="sd">                https://joblib.readthedocs.io/en/latest/parallel.html#parallel-reference-documentation</span>
<span class="sd">        progress: Display a progress bar. Defaults to False.</span>
<span class="sd">        arg_type: One of [&quot;arg&quot;, &quot;args&quot;, &quot;kwargs]:</span>
<span class="sd">            - &quot;arg&quot;: the input is passed as an argument: `fn(arg)` (default).</span>
<span class="sd">            - &quot;args&quot;: the input is passed as a list: `fn(*args)`.</span>
<span class="sd">            - &quot;kwargs&quot;: the input is passed as a map: `fn(**kwargs)`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The results of the execution as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">runner</span> <span class="o">=</span> <span class="n">JobRunner</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="n">progress</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="n">scheduler</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">runner</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">inputs_list</span><span class="p">,</span> <span class="n">arg_type</span><span class="o">=</span><span class="n">arg_type</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamollog"><code>datamol.log</code><a class="headerlink" href="#datamollog" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.log.disable_rdkit_log" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">disable_rdkit_log</span><span class="p">()</span></code>


<a href="#datamol.log.disable_rdkit_log" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Disable all rdkit logs.</p>

        <details class="quote">
          <summary>Source code in <code>datamol/log.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">disable_rdkit_log</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Disable all rdkit logs.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">log_level</span> <span class="ow">in</span> <span class="n">RDLogger</span><span class="o">.</span><span class="n">_levels</span><span class="p">:</span>
        <span class="n">rdBase</span><span class="o">.</span><span class="n">DisableLog</span><span class="p">(</span><span class="n">log_level</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.log.enable_rdkit_log" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">enable_rdkit_log</span><span class="p">()</span></code>


<a href="#datamol.log.enable_rdkit_log" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Enable all rdkit logs.</p>

        <details class="quote">
          <summary>Source code in <code>datamol/log.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">enable_rdkit_log</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Enable all rdkit logs.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">log_level</span> <span class="ow">in</span> <span class="n">RDLogger</span><span class="o">.</span><span class="n">_levels</span><span class="p">:</span>
        <span class="n">rdBase</span><span class="o">.</span><span class="n">EnableLog</span><span class="p">(</span><span class="n">log_level</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="datamol.log.without_rdkit_log" class="doc doc-heading">
        <code>datamol.log.without_rdkit_log</code>



<a href="#datamol.log.without_rdkit_log" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Context manager to disable RDKit logs. By default all logs are disabled.</p>




  <div class="doc doc-children">














  </div>

    </div>

  </div>

<h2 id="datamolmol"><code>datamol.mol</code><a class="headerlink" href="#datamolmol" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.adjust_singleton" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">adjust_singleton</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.mol.adjust_singleton" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Remove all atoms that are essentially disconnected singleton nodes in the molecular graph.
For example, the chlorine atom and methane fragment will be removed in Cl.[N:1]1=CC(O)=CC2CCCCC12.CC.C",
but not the ethane fragment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">adjust_singleton</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Remove all atoms that are essentially disconnected singleton nodes in the molecular graph.</span>
<span class="sd">    For example, the chlorine atom and methane fragment will be removed in Cl.[N:1]1=CC(O)=CC2CCCCC12.CC.C&quot;,</span>
<span class="sd">    but not the ethane fragment.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_rem</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RWMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">to_rem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
    <span class="n">to_rem</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a_idx</span> <span class="ow">in</span> <span class="n">to_rem</span><span class="p">:</span>
        <span class="n">em</span><span class="o">.</span><span class="n">RemoveAtom</span><span class="p">(</span><span class="n">a_idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.atom_indices_to_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">atom_indices_to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.mol.atom_indices_to_mol" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Add the <code>molAtomMapNumber</code> property to each atoms.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>copy</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to copy the molecule.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">atom_indices_to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add the `molAtomMapNumber` property to each atoms.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule</span>
<span class="sd">        copy: Whether to copy the molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="s2">&quot;molAtomMapNumber&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.copy_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.mol.copy_mol" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Copy a molecule and return a new one.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule to copy.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Copy a molecule and return a new one.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule to copy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.copy_mol_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">copy_mol_props</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span></code>


<a href="#datamol.mol.copy_mol_props" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Copy properties from one source molecule to another destination
molecule.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>source</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule to copy from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>destination</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule to copy to.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">copy_mol_props</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copy properties from one source molecule to another destination</span>
<span class="sd">    molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: a molecule to copy from.</span>
<span class="sd">        destination: a molecule to copy to.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">props</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">()</span>
    <span class="n">dm</span><span class="o">.</span><span class="n">set_mol_props</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.decrease_bond" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span></code>


<a href="#datamol.mol.decrease_bond" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Remove one single bond from the input bond. Note that you should
first kekulize your molecules and remove non-standard bond.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bond</code></td>
        <td><code>Bond</code></td>
        <td><p>a bond.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Bond</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Bond</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Remove one single bond from the input bond. Note that you should</span>
<span class="sd">    first kekulize your molecules and remove non-standard bond.</span>

<span class="sd">    Args:</span>
<span class="sd">        bond: a bond.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">TRIPLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DOUBLE_BOND</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">DOUBLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SINGLE_BOND</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">SINGLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">bond</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.enumerate_stereoisomers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">enumerate_stereoisomers</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">n_variants</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">undefined_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rationalise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.mol.enumerate_stereoisomers" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Enumerate the stereocenters and bonds of the current molecule.</p>
<p>Original source: the <code>openff-toolkit</code> lib.</p>
<p>Warning: this function can be computationnaly intensive.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code></code></td>
        <td><p>The molecule whose state we should enumerate.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>n_variants</code></td>
        <td><code>int</code></td>
        <td><p>The maximum amount of molecules that should be returned.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>undefined_only</code></td>
        <td><code>bool</code></td>
        <td><p>If we should enumerate all stereocenters and bonds or only those
with undefined stereochemistry.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>rationalise</code></td>
        <td><code>bool</code></td>
        <td><p>If we should try to build and rationalise the molecule to ensure it
can exist.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">enumerate_stereoisomers</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">,</span>
    <span class="n">n_variants</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">undefined_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">rationalise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enumerate the stereocenters and bonds of the current molecule.</span>

<span class="sd">    Original source: the `openff-toolkit` lib.</span>

<span class="sd">    Warning: this function can be computationnaly intensive.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: The molecule whose state we should enumerate.</span>
<span class="sd">        n_variants: The maximum amount of molecules that should be returned.</span>
<span class="sd">        undefined_only: If we should enumerate all stereocenters and bonds or only those</span>
<span class="sd">            with undefined stereochemistry.</span>
<span class="sd">        rationalise: If we should try to build and rationalise the molecule to ensure it</span>
<span class="sd">            can exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">rdkit.Chem.EnumerateStereoisomers</span> <span class="kn">import</span> <span class="n">EnumerateStereoisomers</span>
    <span class="kn">from</span> <span class="nn">rdkit.Chem.EnumerateStereoisomers</span> <span class="kn">import</span> <span class="n">StereoEnumerationOptions</span>

    <span class="c1"># safety first</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="c1"># in case any bonds/centers are missing stereo chem flag it here</span>
    <span class="n">Chem</span><span class="o">.</span><span class="n">AssignStereochemistry</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flagPossibleStereoCenters</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cleanIt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="n">Chem</span><span class="o">.</span><span class="n">FindPotentialStereoBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">cleanIt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># set up the options</span>
    <span class="n">stereo_opts</span> <span class="o">=</span> <span class="n">StereoEnumerationOptions</span><span class="p">(</span>
        <span class="n">tryEmbedding</span><span class="o">=</span><span class="n">rationalise</span><span class="p">,</span>
        <span class="n">onlyUnassigned</span><span class="o">=</span><span class="n">undefined_only</span><span class="p">,</span>
        <span class="n">maxIsomers</span><span class="o">=</span><span class="n">n_variants</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">isomers</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">EnumerateStereoisomers</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">stereo_opts</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="c1"># NOTE(hadim): often got &quot;Stereo atoms should be specified before specifying CIS/TRANS bond stereochemistry&quot;</span>
        <span class="c1"># for the ligand of reference (coming from the PDB). Not sure how to handle that.</span>
        <span class="n">isomers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">variants</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">isomer</span> <span class="ow">in</span> <span class="n">isomers</span><span class="p">:</span>
        <span class="c1"># isomer has CIS/TRANS tags so convert back to E/Z</span>
        <span class="n">Chem</span><span class="o">.</span><span class="n">SetDoubleBondNeighborDirections</span><span class="p">(</span><span class="n">isomer</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">Chem</span><span class="o">.</span><span class="n">AssignStereochemistry</span><span class="p">(</span><span class="n">isomer</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cleanIt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">variants</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">isomer</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">variants</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.enumerate_tautomers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">enumerate_tautomers</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">n_variants</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>


<a href="#datamol.mol.enumerate_tautomers" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Enumerate the possible tautomers of the current molecule.</p>
<p>Original source: the <code>openff-toolkit</code> lib.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>The molecule whose state we should enumerate.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>n_variants</code></td>
        <td><code>int</code></td>
        <td><p>The maximum amount of molecules that should be returned.</p></td>
        <td><code>20</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">enumerate_tautomers</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">n_variants</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enumerate the possible tautomers of the current molecule.</span>

<span class="sd">    Original source: the `openff-toolkit` lib.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: The molecule whose state we should enumerate.</span>
<span class="sd">        n_variants: The maximum amount of molecules that should be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># safety first</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">enumerator</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">TautomerEnumerator</span><span class="p">()</span>
    <span class="n">enumerator</span><span class="o">.</span><span class="n">SetMaxTautomers</span><span class="p">(</span><span class="n">n_variants</span><span class="p">)</span>
    <span class="n">tautomers</span> <span class="o">=</span> <span class="n">enumerator</span><span class="o">.</span><span class="n">Enumerate</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">tautomers</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.fix_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">fix_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">remove_singleton</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">largest_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.mol.fix_mol" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Fix error in molecule using a greedy approach.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>input molecule to fix</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>n_iter</code></td>
        <td><code>int</code></td>
        <td><p>Number of valence fix iteration to apply</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>remove_singleton</code></td>
        <td><code>bool</code></td>
        <td><p>Whether <code>adjust_singleton</code> should be applied</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>largest_only</code></td>
        <td><code>bool</code></td>
        <td><p>Whether only the largest fragment should be kept</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return a copy of the mol or perform in place operation</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>Fixed molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fix_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">remove_singleton</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">largest_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Fix error in molecule using a greedy approach.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule to fix</span>
<span class="sd">        n_iter: Number of valence fix iteration to apply</span>
<span class="sd">        remove_singleton: Whether `adjust_singleton` should be applied</span>
<span class="sd">        largest_only: Whether only the largest fragment should be kept</span>
<span class="sd">        inplace: Whether to return a copy of the mol or perform in place operation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="ow">or</span> <span class="n">mol</span>  <span class="c1"># fail back to mol when the fixer fail</span>

    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">remove_dummies</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">fix_valence</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">remove_singleton</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">adjust_singleton</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">largest_only</span><span class="p">:</span>
            <span class="c1"># m = max(Chem.rdmolops.GetMolFrags(m, asMols=True, sanitizeFrags=False), key=lambda m: m.GetNumAtoms())</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">FragmentParent</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">skipStandardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.fix_valence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">fix_valence</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_ring_break</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.mol.fix_valence" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Identify and try to fix valence issues by removing any supplemental bond
that should not be in the graph.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code></code></td>
        <td><p>input molecule with incorrect valence for some atoms</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to modify in place or make a copy</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>allow_ring_break</code></td>
        <td><code>bool</code></td>
        <td><p>Whether bond removal involving ring is allowed.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>Fixed potential valence issue in molecule or original molecule when nothing is broken
of if failed.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fix_valence</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">allow_ring_break</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Identify and try to fix valence issues by removing any supplemental bond</span>
<span class="sd">    that should not be in the graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule with incorrect valence for some atoms</span>
<span class="sd">        inplace: Whether to modify in place or make a copy</span>
<span class="sd">        allow_ring_break: Whether bond removal involving ring is allowed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed potential valence issue in molecule or original molecule when nothing is broken</span>
<span class="sd">        of if failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># don&#39;t fix something that is not broken</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RemoveHs</span><span class="p">(</span>
            <span class="n">mol</span><span class="p">,</span>
            <span class="n">implicitOnly</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">updateExplicitCount</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># first pass using explicit false count</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
            <span class="k">while</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="ow">and</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cur_hydrogen</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">SetNumExplicitHs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cur_hydrogen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="c1"># atom.SetNumRadicalElectrons(0)</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">em</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RWMol</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">bond</span>
            <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()),</span>
                    <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()),</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">:</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a2</span><span class="p">):</span>
                <span class="n">mbond</span> <span class="o">=</span> <span class="n">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">allow_ring_break</span> <span class="ow">or</span> <span class="p">(</span><span class="n">mbond</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">bond</span><span class="o">.</span><span class="n">IsInRing</span><span class="p">()):</span>
                    <span class="n">em</span><span class="o">.</span><span class="n">RemoveBond</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">a2</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">mbond</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">a2</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">mbond</span><span class="p">)</span>
            <span class="n">a1</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">a2</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.fix_valence_charge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">fix_valence_charge</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.mol.fix_valence_charge" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Fix valence issues that are due to incorrect charges.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>Input molecule with incorrect valence for some atoms</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inplace</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to modify in place or make a copy.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>Fixed molecule via charge correction or original molecule if failed.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fix_valence_charge</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Fix valence issues that are due to incorrect charges.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: Input molecule with incorrect valence for some atoms</span>
<span class="sd">        inplace: Whether to modify in place or make a copy.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed molecule via charge correction or original molecule if failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>

    <span class="c1"># Don&#39;t fix something that is not broken</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

        <span class="n">mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
            <span class="n">n_electron</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">a</span><span class="o">.</span><span class="n">GetImplicitValence</span><span class="p">()</span>
                <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span>
                <span class="o">-</span> <span class="n">dm</span><span class="o">.</span><span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="n">n_electron</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.incorrect_valence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.mol.incorrect_valence" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Check if an atom connection is not valid or all the atom of a molecule.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>a</code></td>
        <td><code>Union[rdkit.Chem.rdchem.Mol, rdkit.Chem.rdchem.Atom]</code></td>
        <td><p>atom or molecule to check for valence issue.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>update</code></td>
        <td><code>bool</code></td>
        <td><p>Update owning molecule property cache first.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>Whether the input atom valence is correct.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">incorrect_valence</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Atom</span><span class="p">],</span> <span class="n">update</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check if an atom connection is not valid or all the atom of a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        a: atom or molecule to check for valence issue.</span>
<span class="sd">        update: Update owning molecule property cache first.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the input atom valence is correct.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">GetOwningMol</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetImplicitValence</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetValenceList</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">()))</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.is_transition_metal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">)</span></code>


<a href="#datamol.mol.is_transition_metal" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Check if atom is a transition metal.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>at</code></td>
        <td><code>Atom</code></td>
        <td><p>an atom.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Atom</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check if atom is a transition metal.</span>

<span class="sd">    Args:</span>
<span class="sd">        at: an atom.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">22</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">29</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">40</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">47</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">72</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">79</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.keep_largest_fragment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">keep_largest_fragment</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.mol.keep_largest_fragment" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Only keep largest fragment of each molecule.</p>

        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">keep_largest_fragment</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only keep largest fragment of each molecule.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span>
        <span class="n">rdmolops</span><span class="o">.</span><span class="n">GetMolFrags</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">asMols</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="n">mol</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">(),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.randomize_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">randomize_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.mol.randomize_atoms" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Randomize the position of the atoms in a mol.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>mol: a molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">randomize_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Randomize the position of the atoms in a mol.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="n">atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()))</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RenumberAtoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.remove_dummies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">remove_dummies</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dummy</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span></code>


<a href="#datamol.mol.remove_dummies" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Remove dummy atoms from molecules.</p>

        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_dummies</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">dummy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Remove dummy atoms from molecules.&quot;&quot;&quot;</span>
    <span class="n">du</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">mol</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="s2">&quot;[H]&quot;</span><span class="p">),</span> <span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RemoveHs</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">DeleteSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.reorder_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">reorder_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">break_ties</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_chirality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_isotopes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.mol.reorder_atoms" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Reorder the atoms in a mol. It ensures a single atom order for the same molecule,
regardless of its original representation.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>break_ties</code></td>
        <td><code>bool</code></td>
        <td><p>Force breaking of ranked ties.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>include_chirality</code></td>
        <td><code>bool</code></td>
        <td><p>Use chiral information when computing rank.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>include_isotopes</code></td>
        <td><code>bool</code></td>
        <td><p>Use isotope information when computing rank.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>mol: a molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">reorder_atoms</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">break_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_chirality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_isotopes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Reorder the atoms in a mol. It ensures a single atom order for the same molecule,</span>
<span class="sd">    regardless of its original representation.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        break_ties: Force breaking of ranked ties.</span>
<span class="sd">        include_chirality: Use chiral information when computing rank.</span>
<span class="sd">        include_isotopes: Use isotope information when computing rank.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="n">new_order</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">CanonicalRankAtoms</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">breakTies</span><span class="o">=</span><span class="n">break_ties</span><span class="p">,</span>
        <span class="n">includeChirality</span><span class="o">=</span><span class="n">include_chirality</span><span class="p">,</span>
        <span class="n">includeIsotopes</span><span class="o">=</span><span class="n">include_isotopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">new_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_order</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RenumberAtoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">new_order</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.replace_dummies_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">replace_dummies_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">dummy</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">replace_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.mol.replace_dummies_atoms" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Remove dummy atoms from molecules.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>molecule with dummies</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>atom</code></td>
        <td><code>str</code></td>
        <td><p>replacement atom, default is carbon</p></td>
        <td><code>&#39;C&#39;</code></td>
      </tr>
      <tr>
        <td><code>dummy</code></td>
        <td><code>str</code></td>
        <td><p>dummy atom representation</p></td>
        <td><code>&#39;*&#39;</code></td>
      </tr>
      <tr>
        <td><code>replace_all</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to replace all dummies</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>mol: Molecule with dummy replaced</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">replace_dummies_atoms</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">atom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="n">dummy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
    <span class="n">replace_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Remove dummy atoms from molecules.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: molecule with dummies</span>
<span class="sd">        atom: replacement atom, default is carbon</span>
<span class="sd">        dummy: dummy atom representation</span>
<span class="sd">        replace_all: Whether to replace all dummies</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: Molecule with dummy replaced</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">du</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
    <span class="n">replacement</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">replacement</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="n">replace_all</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.sanitize_first" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">sanitize_first</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.mol.sanitize_first" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Sanitize a list of molecules and return the first valid molecule seen in the list.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>a list of molecules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>charge_neutral</code></td>
        <td><code>bool</code></td>
        <td><p>whether charge neutralization should be applied.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>sanifix</code></td>
        <td><code>bool</code></td>
        <td><p>whether to run the sanifix from James Davidson
(sanifix4.py) that try to adjust aromatic nitrogens.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>mol</code></td>
      <td><p>a molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_first</span><span class="p">(</span><span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span> <span class="n">charge_neutral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sanitize a list of molecules and return the first valid molecule seen in the list.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        charge_neutral: whether charge neutralization should be applied.</span>
<span class="sd">        sanifix: whether to run the sanifix from James Davidson</span>
<span class="sd">            (sanifix4.py) that try to adjust aromatic nitrogens.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="n">charge_neutral</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="n">sanifix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mol</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.sanitize_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.mol.sanitize_mol" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Sanitize molecule and fix common errors.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The procedure includes a SMILES conversion to avoid accasional aromaticity
errors. In consequence, all the properties and the conformers will be lost.</p>
</div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>charge_neutral</code></td>
        <td><code>bool</code></td>
        <td><p>whether charge neutralization should be applied.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>sanifix</code></td>
        <td><code>bool</code></td>
        <td><p>whether to run the sanifix from James Davidson
(sanifix4.py) that try to adjust aromatic nitrogens.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>mol: a molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Sanitize molecule and fix common errors.</span>

<span class="sd">    Warning:</span>
<span class="sd">        The procedure includes a SMILES conversion to avoid accasional aromaticity</span>
<span class="sd">        errors. In consequence, all the properties and the conformers will be lost.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        charge_neutral: whether charge neutralization should be applied.</span>
<span class="sd">        sanifix: whether to run the sanifix from James Davidson</span>
<span class="sd">            (sanifix4.py) that try to adjust aromatic nitrogens.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">if</span> <span class="n">charge_neutral</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sanifix</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">_sanifix4</span><span class="o">.</span><span class="n">sanifix</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Try catch to avoid occasional aromaticity errors</span>
            <span class="k">return</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.sanitize_smiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">sanitize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.mol.sanitize_smiles" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Takes SMILES string and returns its sanitized version.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>smiles</code></td>
        <td><code>str</code></td>
        <td><p>smiles to be sanitized.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>isomeric</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to include information about stereochemistry in the SMILES.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>sanitized smiles.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isomeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Takes SMILES string and returns its sanitized version.</span>

<span class="sd">    Args:</span>
<span class="sd">        smiles: smiles to be sanitized.</span>
<span class="sd">        isomeric: Whether to include information about stereochemistry in the SMILES.</span>

<span class="sd">    Returns:</span>
<span class="sd">        sanitized smiles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="n">isomeric</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.set_dative_bonds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">set_dative_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">from_atoms</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span></code>


<a href="#datamol.mol.set_dative_bonds" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Replaces some single bonds between metals and atoms with atomic numbers in fromAtoms
with dative bonds. The replacement is only done if the atom has "too many" bonds.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>molecule with bond to modify</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>from_atoms</code></td>
        <td><code>Tuple[int, int]</code></td>
        <td><p>List of atoms  (symbol or atomic number) to consider for bond replacement.
By default, only Nitrogen (7) and Oxygen (8) are considered.</p></td>
        <td><code>(7, 8)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>The modified molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_dative_bonds</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">from_atoms</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Replaces some single bonds between metals and atoms with atomic numbers in fromAtoms</span>
<span class="sd">    with dative bonds. The replacement is only done if the atom has &quot;too many&quot; bonds.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mol: molecule with bond to modify</span>
<span class="sd">        from_atoms: List of atoms  (symbol or atomic number) to consider for bond replacement.</span>
<span class="sd">            By default, only Nitrogen (7) and Oxygen (8) are considered.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The modified molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rwmol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RWMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">rwmol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">metals</span> <span class="o">=</span> <span class="p">[</span><span class="n">at</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">rwmol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">metal</span> <span class="ow">in</span> <span class="n">metals</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetNeighbors</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="ow">in</span> <span class="n">from_atoms</span> <span class="ow">or</span> <span class="n">nbr</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">()</span> <span class="ow">in</span> <span class="n">from_atoms</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">nbr</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">())</span>
                <span class="ow">and</span> <span class="n">rwmol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">SINGLE_BOND</span>
            <span class="p">):</span>
                <span class="n">rwmol</span><span class="o">.</span><span class="n">RemoveBond</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
                <span class="n">rwmol</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">DATIVE_BOND</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rwmol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.set_mol_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">set_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.mol.set_mol_props" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Set properties to a mol from a dict.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>the mol where to copy the props.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>props</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>the props to copy.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>copy</code></td>
        <td><code>bool</code></td>
        <td><p>whether to copy the provided mol</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_mol_props</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Set properties to a mol from a dict.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: the mol where to copy the props.</span>
<span class="sd">        props: the props to copy.</span>
<span class="sd">        copy: whether to copy the provided mol</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetBoolProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetIntProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetDoubleProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.standardize_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">standardize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">disconnect_metals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reionize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">uncharge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stereo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.mol.standardize_mol" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>This function returns a standardized version the given molecule, with or without disconnect the metals.
The process is apply in the order of the argument.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>The molecule to standardize.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>disconnect_metals</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to disconnect the metallic atoms from non-metals</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>normalize</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply normalization (correct functional groups and recombine charges).</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>reionize</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply molecule reionization</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>uncharge</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to remove all charge from molecule</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>stereo</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to attempt to assign stereochemistry</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>mol</code></td>
      <td><p>The standardized molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">standardize_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">disconnect_metals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">reionize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">uncharge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stereo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns a standardized version the given molecule, with or without disconnect the metals.</span>
<span class="sd">    The process is apply in the order of the argument.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mol: The molecule to standardize.</span>
<span class="sd">        disconnect_metals: Whether to disconnect the metallic atoms from non-metals</span>
<span class="sd">        normalize: Whether to apply normalization (correct functional groups and recombine charges).</span>
<span class="sd">        reionize: Whether to apply molecule reionization</span>
<span class="sd">        uncharge: Whether to remove all charge from molecule</span>
<span class="sd">        stereo: Whether to attempt to assign stereochemistry</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: The standardized molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">disconnect_metals</span><span class="p">:</span>
        <span class="n">md</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">MetalDisconnector</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reionize</span><span class="p">:</span>
        <span class="n">reionizer</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Reionizer</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">reionizer</span><span class="o">.</span><span class="n">reionize</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">uncharge</span><span class="p">:</span>
        <span class="n">uncharger</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Uncharger</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">uncharger</span><span class="o">.</span><span class="n">uncharge</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">stereo</span><span class="p">:</span>
        <span class="n">Chem</span><span class="o">.</span><span class="n">AssignStereochemistry</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cleanIt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.standardize_smiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">standardize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">tautomer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#datamol.mol.standardize_smiles" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Apply smile standardization procedure. This is a convenient function wrapped arrounf RDKit
smiles standardizer and tautomeric canonicalization.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>smiles</code></td>
        <td><code>str</code></td>
        <td><p>Smiles to standardize</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>tautomer</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to canonicalize tautomers</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>standard_smiles</code></td>
      <td><p>the standardized smiles</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">standardize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tautomer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply smile standardization procedure. This is a convenient function wrapped arrounf RDKit</span>
<span class="sd">    smiles standardizer and tautomeric canonicalization.</span>

<span class="sd">    Args:</span>
<span class="sd">        smiles: Smiles to standardize</span>
<span class="sd">        tautomer: Whether to canonicalize tautomers</span>

<span class="sd">    Returns:</span>
<span class="sd">        standard_smiles: the standardized smiles</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">StandardizeSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tautomer</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">canonicalize_tautomer_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.to_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">add_hs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kekulize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#datamol.mol.to_mol" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Convert an input molecule (smiles representation) into a <code>Chem.rdchem.Mol</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>str</code></td>
        <td><p>SMILES of a molecule or a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>add_hs</code></td>
        <td><code>bool</code></td>
        <td><p>Whether hydrogens should be added the molecule.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>explicit_only</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to only add explicit hydrogen or both
(implicit and explicit). when <code>add_hs</code> is set to True.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>ordered</code></td>
        <td><code>bool</code></td>
        <td><p>Whether the atom should be ordered. This option is
important if you want to ensure that the features returned will always maintain
a single atom order for the same molecule, regardless of its original SMILES representation.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>kekulize</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to perform kekulization of the input molecules.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>sanitize</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to apply rdkit sanitization when input is a SMILES.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>mol: the molecule if some conversion have been made. If the conversion fails
None is returned so make sure that you handle this case on your own.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">add_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">explicit_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kekulize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert an input molecule (smiles representation) into a `Chem.rdchem.Mol`.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: SMILES of a molecule or a molecule.</span>
<span class="sd">        add_hs: Whether hydrogens should be added the molecule.</span>
<span class="sd">        explicit_only: Whether to only add explicit hydrogen or both</span>
<span class="sd">            (implicit and explicit). when `add_hs` is set to True.</span>
<span class="sd">        ordered: Whether the atom should be ordered. This option is</span>
<span class="sd">            important if you want to ensure that the features returned will always maintain</span>
<span class="sd">            a single atom order for the same molecule, regardless of its original SMILES representation.</span>
<span class="sd">        kekulize: Whether to perform kekulization of the input molecules.</span>
<span class="sd">        sanitize: Whether to apply rdkit sanitization when input is a SMILES.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: the molecule if some conversion have been made. If the conversion fails</span>
<span class="sd">        None is returned so make sure that you handle this case on your own.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input should be a Chem.rdchem.Mol or a string instead of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sanitize</span> <span class="ow">and</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">mol</span>

    <span class="c1"># Add hydrogens</span>
    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">add_hs</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">_mol</span><span class="p">,</span> <span class="n">explicitOnly</span><span class="o">=</span><span class="n">explicit_only</span><span class="p">)</span>

    <span class="c1"># Reorder atoms</span>
    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ordered</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">reorder_atoms</span><span class="p">(</span><span class="n">_mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">kekulize</span><span class="p">:</span>
        <span class="n">Chem</span><span class="o">.</span><span class="n">Kekulize</span><span class="p">(</span><span class="n">_mol</span><span class="p">,</span> <span class="n">clearAromaticFlags</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_mol</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.mol.to_neutral" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">mol</span><span class="o">.</span><span class="n">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>


<a href="#datamol.mol.to_neutral" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Neutralize the charge of a molecule.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mol</code></td>
        <td><code>Mol</code></td>
        <td><p>a molecule.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[rdkit.Chem.rdchem.Mol]</code></td>
      <td><p>mol: a molecule.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/mol.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Neutralize the charge of a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">())</span>
            <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">):</span>
            <span class="n">a</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div>
        </details>
    </div>

  </div>

<h2 id="datamolsimilarity"><code>datamol.similarity</code><a class="headerlink" href="#datamolsimilarity" title="Permanent link">&para;</a></h2>


  <div class="doc doc-object doc-function">



<h3 id="datamol.similarity.cdist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">similarity</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">mols1</span><span class="p">,</span> <span class="n">mols2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">)</span></code>


<a href="#datamol.similarity.cdist" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Compute the pairwise tanimoto distance between the fingerprints of
each pair of molecules of the two collections of inputs.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols1</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>list of molecules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mols2</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>list of molecules.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>**fp_args</code></td>
        <td><code></code></td>
        <td><p>list of args to pass to <code>to_fp()</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>distmat</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/similarity.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cdist</span><span class="p">(</span>
    <span class="n">mols1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">mols2</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="o">**</span><span class="n">fp_args</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Compute the pairwise tanimoto distance between the fingerprints of</span>
<span class="sd">    each pair of molecules of the two collections of inputs.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols1: list of molecules.</span>
<span class="sd">        mols2: list of molecules.</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>
<span class="sd">        **fp_args: list of args to pass to `to_fp()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        distmat</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fps1</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">),</span>
        <span class="n">mols1</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fps2</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">),</span>
        <span class="n">mols2</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fps1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fps1</span><span class="p">)</span>
    <span class="n">fps2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fps2</span><span class="p">)</span>

    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">fps1</span><span class="p">,</span> <span class="n">fps2</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;jaccard&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dist_mat</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="datamol.similarity.pdist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datamol</span><span class="o">.</span><span class="n">similarity</span><span class="o">.</span><span class="n">pdist</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">)</span></code>


<a href="#datamol.similarity.pdist" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

      <p>Compute the pairwise tanimoto distance between the fingerprints of all the
molecules in the input set.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mols</code></td>
        <td><code>List[rdkit.Chem.rdchem.Mol]</code></td>
        <td><p>list of molecules</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>n_jobs</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>**fp_args</code></td>
        <td><code></code></td>
        <td><p>list of args to pass to <code>to_fp()</code>.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[numpy.ndarray, numpy.ndarray]</code></td>
      <td><p>distmat, valid_idx: Distance matrix, and valid index that have passed the conversion
    to fingerprint.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>datamol/similarity.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pdist</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span> <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Compute the pairwise tanimoto distance between the fingerprints of all the</span>
<span class="sd">    molecules in the input set.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: list of molecules</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>
<span class="sd">        **fp_args: list of args to pass to `to_fp()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        distmat, valid_idx: Distance matrix, and valid index that have passed the conversion</span>
<span class="sd">            to fingerprint.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fps</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">),</span>
        <span class="n">mols</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">valid_idx</span><span class="p">,</span> <span class="n">fps</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span> <span class="k">if</span> <span class="n">fp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">])</span>
    <span class="n">fps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>

    <span class="n">dist</span> <span class="o">=</span> <span class="n">GetTanimotoDistMat</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>
    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">fps</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fps</span><span class="p">)))</span>
    <span class="n">dist_mat</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">dist</span>
    <span class="n">dist_mat</span> <span class="o">+=</span> <span class="n">dist_mat</span><span class="o">.</span><span class="n">T</span>

    <span class="k">return</span> <span class="n">dist_mat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">valid_idx</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../tutorials/Fragment_and_Scaffold.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Fragment and Scaffold
            </div>
          </div>
        </a>
      
      
        <a href="datamol.actions.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              datamol.actions
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2020 - 2021 Valence
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1d3bfcf1.min.js"></script>
      
        <script src="../assets/js/google-analytics.js"></script>
      
    
  </body>
</html>